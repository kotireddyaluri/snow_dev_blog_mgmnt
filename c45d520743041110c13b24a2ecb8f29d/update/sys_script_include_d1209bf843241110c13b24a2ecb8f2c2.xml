<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_script_include">
    <sys_script_include action="INSERT_OR_UPDATE">
        <access>public</access>
        <active>true</active>
        <api_name>sn_blog_management.BlogUtilAjax</api_name>
        <caller_access/>
        <client_callable>true</client_callable>
        <description/>
        <name>BlogUtilAjax</name>
        <script><![CDATA[var BlogUtilAjax = Class.create();
BlogUtilAjax.prototype = Object.extendsObject(global.AbstractAjaxProcessor, {
	titleExists: function(){
		var title = this.getParameter("sysparm_title");
		var author = this.getParameter("sysparm_author");
		var current = this.getParameter("sysparm_current") || "-1";
		
		
		var blog = new GlideRecordSecure("sn_blog_management_blog_post");
		blog.addQuery("title",title);
		blog.addQuery("sys_id","!=",current);
		
		if("" != author && gs.hasRole('sn_blog_management.author'))
			blog.addQuery("author",gs.getUserID());
		blog.query();
		if(blog.next())
			return blog.getValue("sys_id");
		return "-1";
	},
	
	getTitleDetails: function(){
		var table = this.getParameter("sysparm_table");
		var sys_id = this.getParameter("sysparm_id");
		var column = this.getParameter("sysparm_column");
		var operation = this.getParameter("sysparm_operation");
		
		if(operation == "read"){
			var gr = new GlideRecord(table);
			gr.get(sys_id);
			return gr.getValue(column);
		} else if (operation == "delete") {
			var gr2 = new GlideRecord(table);
			gr2.get(sys_id);
			gr2.deleteRecord();
		}else if (operation == "insert") {
			var gr3 = new GlideRecord(table);
			var col1 = this.getParameter("sysparm_col1");
			var vl1 = this.getParameter("sysparm_vl1");
			var col2= this.getParameter("sysparm_col2");
			var vl2=this.getParameter("sysparm_vl2");
			gr3.initialize();
			gr3.setValue(col1,vl1);
			gr3.setValue(col2,vl2);
			gr3.insert();
			
		}
		
    },
	
	getUserManager: function(user){
		var user_gr = new GlideRecord("sys_user");
		user_gr.get(user);
		gs.info("getUserManager() called..");
		return user_gr.getValue("manager");
	},
	
	getIncidentShortDesc: function(incident,sys_id){
		var incident_gr = new GlideRecord("incident");
		incident_gr.get(sys_id);
		return incident_gr.getValue("short_description");
	},
	
	isPublic: function(){
		return true;
	},
	
    type: 'BlogUtilAjax'
});]]></script>
        <sys_class_name>sys_script_include</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2022-07-05 11:32:46</sys_created_on>
        <sys_id>d1209bf843241110c13b24a2ecb8f2c2</sys_id>
        <sys_name>BlogUtilAjax</sys_name>
        <sys_package display_value="Blog Management" source="sn_blog_management">c45d520743041110c13b24a2ecb8f29d</sys_package>
        <sys_policy>read</sys_policy>
        <sys_scope display_value="Blog Management">c45d520743041110c13b24a2ecb8f29d</sys_scope>
        <sys_update_name>sys_script_include_d1209bf843241110c13b24a2ecb8f2c2</sys_update_name>
    </sys_script_include>
</record_update>
